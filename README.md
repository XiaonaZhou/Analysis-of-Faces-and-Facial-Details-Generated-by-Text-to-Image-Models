# Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models

## Overview

In this project, we reproduced the results of [Borji](https://arxiv.org/abs/2210.00586) and extended the work to further analysis of facial details, eyes and mouth. We also included a new diffusion model, ERNIE-ViLG, that achieves state-of-the-art on MS-COCO with zero-shot FID score of 6.75, which outperforms Googleâ€™s Imagen. We find that despite being the state-of-the-art Text-to-Image model, ERNIE-ViLG scores highest in FID score on all categories. While DALL-E 2 struggles more with generating natural eyes, Midjourney falls short on mouth details. we explored possible reasons and included some analysis of the model.

## Instruction

I would not suggest rerun any of the codes that generate or extracte images. Datasets needed to reproduce results in the [report](https://github.com/XiaonaZhou/Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models/blob/main/CS5824_Analysis_on_the_new_state_of_the_art_model_ERNIE_ViLG_project.pdf) are listed under *Dataset* section below, and you can directly run the [notebook](https://github.com/XiaonaZhou/Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models/blob/main/ERNIE_ViLG_analysis/FID_score_plot.ipynb) to regenerate plots. If you are interested in seeing how FID scores were calculated, go [here](https://github.com/XiaonaZhou/Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models/blob/main/ERNIE_ViLG_analysis/FID_score_Real_and_ERNIE.ipynb), and you can see which datasets were used. From there, you can find how the dataset were produced from corresponding Jupyter notebooks. 

### Codes
1. [Code for extracting face images from COCO dataset](https://github.com/XiaonaZhou/Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models/blob/main/Extract_faces_from_COCO_dataset.ipynb).
2. [Code for extracting eyes area from face images](https://github.com/XiaonaZhou/Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models/blob/main/ERNIE_ViLG_analysis/eyes_extraction.ipynb).
3. [Code for extracting mouth from face images](https://github.com/XiaonaZhou/Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models/blob/main/ERNIE_ViLG_analysis/mouth_extraction.ipynb).
4. [Code for generating face images from ERNIE](https://github.com/XiaonaZhou/Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models/blob/main/ERNIE_ViLG_analysis/ERNIE_ViLG_Face_Image_Generation.ipynb): You will not be able to generate image without a valid API key and Secert key. 
5. [Code for calculating FID scores](https://github.com/XiaonaZhou/Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models/blob/main/ERNIE_ViLG_analysis/FID_score_Real_and_ERNIE.ipynb).
6. [Code for ploting FID scores](https://github.com/XiaonaZhou/Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models/blob/main/ERNIE_ViLG_analysis/FID_score_plot.ipynb).

### Dataset
1. [GFW](https://github.com/XiaonaZhou/Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models/tree/main/ERNIE_ViLG_analysis/GFW): facce image dataset provided by [Borji](https://arxiv.org/abs/2210.00586).
2. **COCO:**[Extracted face images from COCO](https://github.com/XiaonaZhou/Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models/tree/main/extracted_faces_from_COCO), [eyes images](), [mouth images](), [face images resized to 100 by 100 for FID calculation against GFW real face image](https://github.com/XiaonaZhou/Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models/tree/main/ERNIE_ViLG_analysis/extracted_face_from_COCO_100_by_100). 
3. **Real images from GFW:** [face images](https://github.com/XiaonaZhou/Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models/tree/main/ERNIE_ViLG_analysis/GFW/real_faces), [eyes images](https://github.com/XiaonaZhou/Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models/tree/main/ERNIE_ViLG_analysis/extracted_real_eyes_GFW), [mouth images](https://github.com/XiaonaZhou/Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models/tree/main/ERNIE_ViLG_analysis/extracted_real_mouth_GFW).
4. **ERNIR-ViLG:** [Extracted face image after manual filtering](https://github.com/XiaonaZhou/Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models/tree/main/ERNIE_ViLG_analysis/combined_filtered_generated_faces), [eyes images](https://github.com/XiaonaZhou/Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models/tree/main/ERNIE_ViLG_analysis/extracted_eyes_ERNIE), [mouth images](https://github.com/XiaonaZhou/Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models/tree/main/ERNIE_ViLG_analysis/extracted_mouth_ERNIE), [face images resized to 100 by 100](https://github.com/XiaonaZhou/Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models/tree/main/ERNIE_ViLG_analysis/combined_filtered_generated_faces_100_by_100).
5. **Stable Diffusion:** [extracted face images](https://github.com/XiaonaZhou/Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models/tree/main/ERNIE_ViLG_analysis/GFW/StableDiffusion), [eyes images](https://github.com/XiaonaZhou/Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models/tree/main/ERNIE_ViLG_analysis/extracted_generated_eyes_St_D), [mouth images](https://github.com/XiaonaZhou/Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models/tree/main/ERNIE_ViLG_analysis/extracted_generated_mouth_St_D).
6. **DALL-E 2:** [extracted face images](https://github.com/XiaonaZhou/Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models/tree/main/ERNIE_ViLG_analysis/GFW/DALLE2), [eyes images](https://github.com/XiaonaZhou/Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models/tree/main/ERNIE_ViLG_analysis/extracted_generated_eyes_DALLE2), [mouth images](https://github.com/XiaonaZhou/Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models/tree/main/ERNIE_ViLG_analysis/extracted_generated_mouth_DALLE2).
7. **Midjourney:** [extracted face images](https://github.com/XiaonaZhou/Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models/tree/main/ERNIE_ViLG_analysis/GFW/Midjourney), [eyes images](https://github.com/XiaonaZhou/Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models/tree/main/ERNIE_ViLG_analysis/extracted_generated_eyes_Mid), [mouth images](https://github.com/XiaonaZhou/Analysis-of-Faces-and-Facial-Details-Generated-by-Text-to-Image-Models/tree/main/ERNIE_ViLG_analysis/extracted_generated_mouth_Mid).





